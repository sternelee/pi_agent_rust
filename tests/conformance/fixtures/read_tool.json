{
  "version": "1.0",
  "tool": "read",
  "description": "Conformance tests for the read tool",
  "cases": [
    {
      "name": "read_simple_file",
      "description": "Read a simple text file",
      "setup": [
        {"type": "create_file", "path": "test.txt", "content": "line1\nline2\nline3\nline4\nline5"}
      ],
      "input": {"path": "test.txt"},
      "expected": {
        "content_exact": "    1\u2192line1\n    2\u2192line2\n    3\u2192line3\n    4\u2192line4\n    5\u2192line5",
        "details_none": true
      }
    },
    {
      "name": "read_with_offset",
      "description": "Read file starting from a specific line",
      "setup": [
        {"type": "create_file", "path": "test.txt", "content": "line1\nline2\nline3\nline4\nline5"}
      ],
      "input": {"path": "test.txt", "offset": 3},
      "expected": {
        "content_exact": "    3\u2192line3\n    4\u2192line4\n    5\u2192line5",
        "details_none": true
      }
    },
    {
      "name": "read_with_limit",
      "description": "Read file with line limit",
      "setup": [
        {"type": "create_file", "path": "test.txt", "content": "line1\nline2\nline3\nline4\nline5"}
      ],
      "input": {"path": "test.txt", "limit": 2},
      "expected": {
        "content_exact": "    1\u2192line1\n    2\u2192line2\n\n[3 more lines in file. Use offset=3 to continue.]",
        "details_none": true
      }
    },
    {
      "name": "read_with_offset_and_limit",
      "description": "Read file with both offset and limit",
      "setup": [
        {"type": "create_file", "path": "test.txt", "content": "line1\nline2\nline3\nline4\nline5"}
      ],
      "input": {"path": "test.txt", "offset": 2, "limit": 2},
      "expected": {
        "content_exact": "    2\u2192line2\n    3\u2192line3\n\n[2 more lines in file. Use offset=4 to continue.]",
        "details_none": true
      }
    },
    {
      "name": "read_offset_out_of_bounds",
      "description": "Offset beyond EOF should error with an actionable message",
      "setup": [
        {"type": "create_file", "path": "test.txt", "content": "line1\nline2\nline3\nline4\nline5"}
      ],
      "input": {"path": "test.txt", "offset": 999},
      "expect_error": true,
      "error_contains": "Offset 999 is beyond end of file",
      "expected": {}
    },
    {
      "name": "read_nonexistent_file",
      "description": "Reading a nonexistent file should error",
      "input": {"path": "/nonexistent/path/file.txt"},
      "expect_error": true,
      "error_contains": "No such file",
      "expected": {}
    },
    {
      "name": "read_directory",
      "description": "Reading a directory should error",
      "setup": [
        {"type": "create_dir", "path": "mydir"}
      ],
      "input": {"path": "mydir"},
      "expect_error": true,
      "error_contains": "directory",
      "expected": {}
    },
    {
      "name": "read_empty_file",
      "description": "Read an empty file",
      "setup": [
        {"type": "create_file", "path": "empty.txt", "content": ""}
      ],
      "input": {"path": "empty.txt"},
      "expected": {
        "content_exact": "",
        "details_none": true
      }
    },
    {
      "name": "read_unicode_content",
      "description": "Read file with Unicode content",
      "setup": [
        {"type": "create_file", "path": "unicode.txt", "content": "Hello \u4e16\u754c\n\u3053\u3093\u306b\u3061\u306f\n\ud83c\udf89 emoji"}
      ],
      "input": {"path": "unicode.txt"},
      "expected": {
        "content_exact": "    1\u2192Hello \u4e16\u754c\n    2\u2192\u3053\u3093\u306b\u3061\u306f\n    3\u2192\ud83c\udf89 emoji",
        "details_none": true
      }
    },
    {
      "name": "read_nested_path",
      "description": "Read file in nested directory",
      "setup": [
        {"type": "create_file", "path": "a/b/c/deep.txt", "content": "deeply nested content"}
      ],
      "input": {"path": "a/b/c/deep.txt"},
      "expected": {
        "content_exact": "    1\u2192deeply nested content",
        "details_none": true
      }
    },
    {
      "name": "read_trailing_newline",
      "description": "Read file with trailing newline",
      "setup": [
        {"type": "create_file", "path": "trailing.txt", "content": "line1\nline2\n"}
      ],
      "input": {"path": "trailing.txt"},
      "expected": {
        "content_exact": "    1\u2192line1\n    2\u2192line2\n    3\u2192",
        "details_none": true
      }
    },
    {
      "name": "read_no_trailing_newline",
      "description": "Read file without trailing newline",
      "setup": [
        {"type": "create_file", "path": "notrailing.txt", "content": "no trailing newline"}
      ],
      "input": {"path": "notrailing.txt"},
      "expected": {
        "content_exact": "    1\u2192no trailing newline",
        "details_none": true
      }
    },
    {
      "name": "read_single_line",
      "description": "Read file with single line",
      "setup": [
        {"type": "create_file", "path": "single.txt", "content": "only one line"}
      ],
      "input": {"path": "single.txt"},
      "expected": {
        "content_exact": "    1\u2192only one line",
        "details_none": true
      }
    },
    {
      "name": "read_many_empty_lines",
      "description": "Read file with multiple empty lines",
      "setup": [
        {"type": "create_file", "path": "blanks.txt", "content": "line1\n\n\n\nline2"}
      ],
      "input": {"path": "blanks.txt"},
      "expected": {
        "content_exact": "    1\u2192line1\n    2\u2192\n    3\u2192\n    4\u2192\n    5\u2192line2",
        "details_none": true
      }
    },
    {
      "name": "read_crlf_line_endings",
      "description": "Read file with Windows-style line endings",
      "setup": [
        {"type": "create_file", "path": "windows.txt", "content": "line1\r\nline2\r\nline3"}
      ],
      "input": {"path": "windows.txt"},
      "expected": {
        "content_contains": ["line1", "line2", "line3"],
        "details_none": true
      }
    },
    {
      "name": "read_special_characters",
      "description": "Read file with special characters",
      "setup": [
        {"type": "create_file", "path": "special.txt", "content": "Tab:\there\nQuotes: \"quoted\"\nBackslash: \\path"}
      ],
      "input": {"path": "special.txt"},
      "expected": {
        "content_contains": ["Tab:\there", "Quotes: \"quoted\"", "Backslash: \\path"],
        "details_none": true
      }
    },
    {
      "name": "read_long_lines",
      "description": "Read file with very long lines",
      "setup": [
        {"type": "create_file", "path": "long.txt", "content": "short\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nend"}
      ],
      "input": {"path": "long.txt"},
      "expected": {
        "content_contains": ["short", "AAAA", "end"],
        "details_none": true
      }
    },
    {
      "name": "read_zero_offset",
      "description": "Offset 0 should start from the beginning (equivalent to no offset)",
      "setup": [
        {"type": "create_file", "path": "test.txt", "content": "line1\nline2\nline3"}
      ],
      "input": {"path": "test.txt", "offset": 0},
      "expected": {
        "content_exact": "    1\u2192line1\n    2\u2192line2\n    3\u2192line3",
        "details_none": true
      }
    },
    {
      "name": "read_offset_at_last_line",
      "description": "Offset at the exact last line",
      "setup": [
        {"type": "create_file", "path": "test.txt", "content": "line1\nline2\nline3"}
      ],
      "input": {"path": "test.txt", "offset": 3},
      "expected": {
        "content_exact": "    3\u2192line3",
        "details_none": true
      }
    },
    {
      "name": "read_limit_greater_than_lines",
      "description": "Limit larger than available lines should return all lines",
      "setup": [
        {"type": "create_file", "path": "test.txt", "content": "line1\nline2\nline3"}
      ],
      "input": {"path": "test.txt", "limit": 100},
      "expected": {
        "content_exact": "    1\u2192line1\n    2\u2192line2\n    3\u2192line3",
        "details_none": true
      }
    },
    {
      "name": "read_dotfile",
      "description": "Read hidden dotfile",
      "setup": [
        {"type": "create_file", "path": ".hidden", "content": "secret content"}
      ],
      "input": {"path": ".hidden"},
      "expected": {
        "content_exact": "    1\u2192secret content",
        "details_none": true
      }
    },
    {
      "name": "read_json_content",
      "description": "Read file with JSON content",
      "setup": [
        {"type": "create_file", "path": "data.json", "content": "{\"key\": \"value\", \"num\": 42}"}
      ],
      "input": {"path": "data.json"},
      "expected": {
        "content_exact": "    1\u2192{\"key\": \"value\", \"num\": 42}",
        "details_none": true
      }
    },
    {
      "name": "read_markdown_content",
      "description": "Read file with markdown content",
      "setup": [
        {"type": "create_file", "path": "readme.md", "content": "# Title\n\n- bullet 1\n- bullet 2\n\n```rust\nfn main() {}\n```"}
      ],
      "input": {"path": "readme.md"},
      "expected": {
        "content_contains": ["# Title", "bullet", "fn main"],
        "details_none": true
      }
    }
  ]
}
